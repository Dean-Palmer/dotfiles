!function(t){var e={};function s(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(i,o,function(e){return t[e]}.bind(null,o));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=5)}({2:function(t,e,s){"use strict";s.d(e,"a",function(){return n}),s.d(e,"b",function(){return r});var i=function(){},o=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.super=e.prototype},l=function(t,e,s){this.type=t,this.el=document.querySelector("#"+t+"-autocomplete"),this.filter=document.querySelector("#toggl-button-"+t+"-filter"),this.filterClear=this.el.parentNode.querySelector(".filter-clear"),this.placeholderItem=document.querySelector("#toggl-button-"+t+"-placeholder"),this.placeholderDiv=this.placeholderItem.querySelector("div"),this.clearSelected=this.el.querySelector("."+t+"-clear"),this.addLink=this.el.parentNode.querySelector(".add-new-"+t),this.elem=s,this.item=e,this.lastFilter="",this.listItems=[],this.exactMatch=!1,this.addEvents()};l.prototype.addEvents=function(){var t=this;t.placeholderItem.addEventListener("click",function(e){setTimeout(function(){t.filter.focus()},50)}),window.addEventListener("focus",function(e){e.target===t.filter&&t.openDropdown()},!0),t.filter.addEventListener("keydown",function(e){"Tab"===e.code&&t.closeDropdown(),"Enter"===e.code&&(t.filter.parentNode.classList.contains("open")&&t.saveSelected&&(t.saveSelected(),e.stopPropagation(),e.preventDefault()),t.closeDropdown()),"Escape"===e.code&&t.placeholderItem.parentNode.classList.contains("open")&&(t.closeDropdown(),e.stopPropagation(),e.preventDefault())}),t.filter.addEventListener("keyup",function(e){t.filterSelection()}),t.filterClear.addEventListener("click",function(e){t.closeDropdown(),e.preventDefault()})},l.prototype.clearFilters=function(){this.el.classList.remove("filtered");var t,e=this.el.querySelectorAll(".filter"),s=this.el.querySelectorAll(".tasklist-opened");for(t=0;t<e.length;t++)e[t].classList.remove("filter");for(t=0;t<s.length;t++)s[t].classList.remove("tasklist-opened")},l.prototype.openDropdown=function(){this.filter.parentNode.classList.add("open"),this.listItems=this.el.querySelectorAll(this.item),this.visibleItems=this.el.querySelectorAll("."+this.type+"-row"),this.updateHeight()},l.prototype.closeDropdown=function(t){var e=t||this;e.filter.value="",e.el.classList.remove("filtered"),e.placeholderItem.parentNode.classList.remove("open"),e.placeholderItem.parentNode.classList.remove("add-allowed"),e.clearFilters()},l.prototype.updateHeight=function(){var t,e=document.body.getBoundingClientRect(),s=this.el.getBoundingClientRect(),i="max-height:auto;",o="max-height:auto;";e.bottom>0&&s.bottom+25>=e.bottom&&((t=window.scrollY+e.bottom-s.top-10)<55&&(t=55),i="max-height: "+t+"px;",o="max-height: "+(t-25)+"px;"),this.el.style=i,"tag"===this.type&&(document.querySelector(".tag-list").style=o)};var n=function(t,e,s){l.call(this,t,e,s),this.onChangeHandler=i,this.selectedItem=-1,this.selectedTask=-1,this.visibleItems=[],this.visibleTasks=[]};o(n,l),n.prototype.setup=function(t,e){this.setSelected(t,e),this.placeholderDiv.textContent=this.placeholderDiv.title=this.generateLabel(null,t,this.type,e),this.setProjectBullet(t,e)},n.prototype.addEvents=function(){var t,e=this;this.super.addEvents.call(this),e.el.addEventListener("click",function(t){t.stopPropagation(),e.selectProject(t.target)}),e.filter.addEventListener("keydown",function(s){38===s.keyCode?e.selectPrevious():40===s.keyCode?e.selectNext():37!==s.keyCode&&39!==s.keyCode||(t=e.visibleItems[e.selectedItem]).querySelector(".task-count")&&(e.clearSelectedTask(),e.toggleTaskList(t.querySelector(".task-count")))})},n.prototype.clearSelectedItem=function(){var t=this.el.querySelector(".selected-item");t&&t.classList.remove("selected-item")},n.prototype.clearSelectedTask=function(){var t=this.el.querySelector(".task-item.selected-item");t&&t.classList.remove("selected-item")},n.prototype.selectPrevious=function(){if(-1!==this.selectedItem){if(-1!==this.selectedTask&&this.visibleItems[this.selectedItem].classList.contains("tasklist-opened")&&(this.clearSelectedTask(),this.selectedTask>0))return this.selectedTask--,this.visibleTasks[this.selectedTask].classList.add("selected-item"),void this.scrollUpToView(this.el,this.visibleTasks[this.selectedTask]);this.clearSelectedItem(),this.selectedItem>0?this.selectedItem--:this.selectedItem=this.visibleItems.length-1,this.visibleItems[this.selectedItem].classList.add("selected-item"),this.selectedItem===this.visibleItems.length-1&&this.visibleItems[this.selectedItem].scrollIntoView(!1),this.scrollUpToView(this.el,this.visibleItems[this.selectedItem]),this.visibleItems[this.selectedItem].classList.contains("tasklist-opened")&&(0===this.visibleTasks.length&&(this.visibleTasks=this.visibleItems[this.selectedItem].querySelectorAll("li.task-item")),this.selectedTask=this.visibleTasks.length-1,this.visibleTasks[this.selectedTask].classList.add("selected-item"),this.scrollUpToView(this.el,this.visibleTasks[this.selectedTask]))}},n.prototype.selectNext=function(){if(-1!==this.selectedItem&&this.visibleItems[this.selectedItem].classList.contains("tasklist-opened")){if(0===this.visibleTasks.length)return this.selectedTask=0,this.visibleTasks=this.visibleItems[this.selectedItem].querySelectorAll("li.task-item"),this.visibleTasks[this.selectedTask].classList.add("selected-item"),void this.scrollDownToView(this.el,this.visibleTasks[this.selectedTask]);if(this.clearSelectedTask(),this.selectedTask<this.visibleTasks.length-1)return this.selectedTask++,this.visibleTasks[this.selectedTask].classList.add("selected-item"),void this.scrollDownToView(this.el,this.visibleTasks[this.selectedTask])}this.selectedTask=-1,this.visibleTasks=[],this.clearSelectedItem(),this.selectedItem<this.visibleItems.length-1?this.selectedItem++:this.selectedItem=0,this.visibleItems[this.selectedItem].classList.add("selected-item"),0===this.selectedItem&&this.visibleItems[this.selectedItem].scrollIntoView(),this.scrollDownToView(this.el,this.visibleItems[this.selectedItem])},n.prototype.scrollDownToView=function(t,e){t.scrollTop+t.offsetHeight<e.offsetTop+e.offsetHeight&&e.scrollIntoView(!1)},n.prototype.scrollUpToView=function(t,e){t.scrollTop>e.offsetTop&&e.scrollIntoView()},n.prototype.saveSelected=function(){this.visibleTasks[this.selectedTask]?this.selectTask(this.visibleTasks[this.selectedTask]):this.visibleItems[this.selectedItem]&&this.selectProject(this.visibleItems[this.selectedItem]),this.closeDropdown()},n.prototype.setSelected=function(t,e){var s=this.el.querySelector("li[data-tid='"+e+"']");s?this.selectTask(s,!0):this.setSelectedProject(t)},n.prototype.setSelectedProject=function(t){var e,s=this.el.querySelectorAll(".selected-"+this.type);if(s.length>=1)for(e=0;e<s.length;e++)s[e].classList.remove("selected-"+this.type);t&&this.el.querySelector("li[data-pid='"+t+"']").classList.add("selected-"+this.type)},n.prototype.selectTask=function(t,e){var s=this.el.querySelector(".selected-task");s&&s.classList.remove("selected-task"),t.classList.add("selected-task"),this.selectProject(t.parentNode.parentNode,e,!0)},n.prototype.selectProject=function(t,e,s){if(t.classList.contains("item-name")&&(t=t.parentNode),!t.classList.contains(this.type+"-row"))return t.classList.contains("task-count")&&this.toggleTaskList(t),t.classList.contains("task-item")&&this.selectTask(t),void this.onChangeHandler(this.getSelected());!s&&this.el.querySelector(".selected-task")&&this.el.querySelector(".selected-task").classList.remove("selected-task");var i=this.el.querySelector(".selected-"+this.type),o=t.getAttribute("data-pid");return i&&i.classList.remove("selected-"+this.type),t.classList.add("selected-"+this.type),this.placeholderDiv.textContent=this.placeholderDiv.title=this.generateLabel(this.getSelected(),o,this.type),this.setProjectBullet(o),e||this.closeDropdown(),this.elem.updateBillable(parseInt(o,10)),this.onChangeHandler(this.getSelected()),!1},n.prototype.toggleTaskList=function(t){var e=this.el.querySelector(".tasklist-opened");e&&e.classList.remove("tasklist-opened"),e!==t.parentNode&&t.parentNode.classList.toggle("tasklist-opened")},n.prototype.getSelected=function(){var t=this.el.querySelector(".selected-"+this.type),e=this.el.querySelector(".selected-task");return{el:t,pid:t?parseInt(t.getAttribute("data-pid"),10):0,tid:e?parseInt(e.getAttribute("data-tid"),10):null,name:t?t.getAttribute("title"):""}},n.prototype.getSelectedProjectByPid=function(t){var e=this.el.querySelector("li[data-pid='"+t+"']");return{el:e,pid:t,name:e?e.textContent:""}},n.prototype.setProjectBullet=function(t,e,s){var i,o,l,n=s||this.placeholderItem.querySelector(".tb-project-bullet");return(t||"0"===t)&&(i=this.el.querySelector("li[data-pid='"+t+"']"))?(n.className=i.querySelector(".tb-project-bullet").className,n.setAttribute("style",i.querySelector(".tb-project-bullet").getAttribute("style")),o=" - "+i.getAttribute("title"),e&&(l=i.querySelector("li[data-tid='"+e+"']"))&&(o+=" . "+l.getAttribute("title")),o):(n.className="tb-project-bullet","")},n.prototype.generateLabel=function(t,e,s,i){var o,l,n=!1,r="";return(t=this.getSelectedProjectByPid(e))||(t=this.getSelected()),t&&t.el&&(n=t.pid,(l=t.el.querySelector(".selected-task")||t.el.querySelector("li[data-tid='"+i+"']"))&&(r+=l.getAttribute("title")+" . "),(o=t.el.parentNode.querySelector(".client-row"))&&(r=o.textContent+" - "),r+=t.el.getAttribute("title")),0!==parseInt(e,10)&&n?r:"Add "+s},n.prototype.filterSelection=function(){var t,e,s,i=this.filter.value.toLowerCase();if(this.updateHeight(),i!==this.lastFilter)if(i.length>0&&!this.el.classList.contains("filtered")&&this.el.classList.add("filtered"),0!==i.length){for(t in this.visibleItems=[this.el.querySelector("p."+this.type+"-row")],this.lastFilter=i,this.exactMatch=!1,this.listItems)this.listItems.hasOwnProperty(t)&&(-1!==(s=(e=this.listItems[t]).getAttribute("title").toLowerCase()).indexOf(i)?(s===i&&(this.exactMatch=i),this.visibleItems.push(e),e.classList.add("filter"),e.classList.contains("project-row")&&(e.parentNode.classList.add("filter"),e.parentNode.parentNode.classList.add("filter")),e.classList.contains("client-row")&&e.parentNode.classList.add("filter-match"),e.classList.contains("task-item")&&(e.parentNode.parentNode.classList.add("filter"),e.parentNode.parentNode.classList.add("tasklist-opened"),e.classList.add("filter"))):e.classList&&(e.classList.remove("filter"),e.classList.contains("task-item")?(e.classList.remove("filter"),0===e.parentNode.querySelectorAll(".filter").length&&e.parentNode.parentNode.classList.remove("tasklist-opened")):(0===e.parentNode.querySelectorAll(".filter").length&&e.parentNode.classList.remove("filter"),0===e.parentNode.parentNode.querySelectorAll(".filter").length&&e.parentNode.parentNode.classList.remove("filter"),e.classList.contains("client-row")&&(e.classList.remove("filter-match"),e.parentNode.classList.remove("filter-match"),e.parentNode.parentNode.classList.remove("filter-match")))));this.updateHeight()}else this.clearFilters()},n.prototype.closeDropdown=function(){this.super.closeDropdown(this,this),this.clearSelectedItem(),this.selectedItem=-1},n.prototype.onChange=function(t){this.onChangeHandler=t},n.prototype.removeChangeHandler=function(){this.onChangeHandler=i};var r=function(t,e,s){l.call(this,t,e,s),this.wid=null};o(r,l),r.prototype.setup=function(t,e){this.setSelected(t),this.setWorkspaceId(e)},r.prototype.addEvents=function(){var t=this;t.placeholderItem.addEventListener("click",function(e){setTimeout(function(){t.filter.focus()},50)}),window.addEventListener("focus",function(e){e.target===t.filter&&t.openDropdown()},!0),this.el.addEventListener("click",function(e){e.stopPropagation(),t.selectTag(e)}),this.filter.addEventListener("keyup",function(e){t.filterSelection()}),this.filter.addEventListener("keydown",function(e){"Tab"===e.code&&t.closeDropdown(),13===e.keyCode&&(e.preventDefault(),t.addNew()),27===e.keyCode&&(e.preventDefault(),t.closeDropdown())}),this.filterClear.addEventListener("click",function(e){t.closeDropdown(),e.preventDefault()}),this.clearSelected.addEventListener("click",function(e){t.clearSelectedTags()}),this.addLink.addEventListener("click",function(e){t.addNew()})},r.prototype.closeDropdown=function(){this.super.closeDropdown(this,this),this.updatePlaceholder()},r.prototype.selectTag=function(t){t.target.classList.toggle("selected-tag")},r.prototype.setSelected=function(t){var e,s;if(this.clearSelectedTags(),t)for(e=0;e<t.length;e+=1)(s=this.el.querySelector("li[title='"+t[e]+"']"))?s.classList.add("selected-"+this.type):this.addNew(t[e]);this.updatePlaceholder(t)},r.prototype.setWorkspaceId=function(t){this.wid=t;var e,s,i=this.el.querySelectorAll(this.item),o=t.toString();for(s in i)i.hasOwnProperty(s)&&((e=i[s]).dataset.wid===o||"nowid"===o?e.classList.remove("workspace-filter"):e.classList.add("workspace-filter"))},r.prototype.clearSelectedTags=function(t){var e,s=this.el.querySelectorAll(".tag-list li.selected-tag");for(e=0;e<s.length;e+=1)s[e].classList.remove("selected-tag")},r.prototype.updatePlaceholder=function(t){t||(t=this.getSelected()),t=t&&t.length?t.join(","):"Add tags",this.placeholderDiv.textContent=this.placeholderDiv.title=t},r.prototype.getSelected=function(){var t,e,s=[],i=this.el.querySelectorAll(".tag-list .selected-tag");for(e=0;e<i.length;e+=1)t=i[e].textContent,s.push(t);return s},r.prototype.filterSelection=function(){var t,e,s,i=this.filter.value.toLowerCase();if(i!==this.lastFilter)if(i.length>0&&!this.el.classList.contains("filtered")&&this.el.classList.add("filtered"),0!==i.length){for(t in this.lastFilter=i,this.exactMatch=!1,this.listItems)this.listItems.hasOwnProperty(t)&&(-1!==(s=(e=this.listItems[t]).getAttribute("title").toLowerCase()).indexOf(i)?(s===i&&(this.exactMatch=i),e.classList.add("filter")):e.classList&&e.classList.remove("filter"));this.updateAddLink()}else this.clearFilters()},r.prototype.updateAddLink=function(t){this.addLink&&(this.exactMatch?this.placeholderItem.parentNode.classList.remove("add-allowed"):this.placeholderItem.parentNode.classList.add("add-allowed"))},r.prototype.addNew=function(t){var e=t||this.filter.value,s=this.el.querySelector("."+this.type+"-list"),i=document.createElement("li");e&&(i.className=this.type+"-item selected-"+this.type,i.setAttribute("title",e),i.textContent=e,s.insertBefore(i,s.querySelector("li:first-child")),this.filter.value="",this.filterSelection())}},5:function(t,e,s){"use strict";s.r(e);var i=s(2);let o,l;function n(t){return t instanceof Function?t():t}function r(t){t.focus(),t.setSelectionRange(0,0),t.scrollLeft=0}window.$=((t,e)=>(e=e||document).querySelector(t)),window.createTag=((t,e,s)=>{const i=document.createElement(t);return i.className=e,s&&(i.textContent=s),i}),window.togglbutton={$billable:null,isStarted:!1,element:null,links:[],serviceName:"",projectBlurTrigger:null,taskBlurTrigger:null,tagsVisible:!1,hasTasks:!1,entries:{},projects:{},user:{},duration_format:"",currentDescription:"",fullPageHeight:function(){const t=document.body,e=document.documentElement;return Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight)}(),fullVersion:"TogglButton",render:function(t,e,s,i){chrome.runtime.sendMessage({type:"activate"},function(o){if(o.success)try{if(togglbutton.user=o.user,togglbutton.entries=o.user.time_entries,togglbutton.projects=o.user.projectMap,togglbutton.fullVersion=o.version,togglbutton.duration_format=o.user.duration_format,e.observe){new MutationObserver(function(e){const o=e.filter(function(t){return t.target.matches(i)});i&&!o.length||togglbutton.renderTo(t,s)}).observe(document,{childList:!0,subtree:!0})}togglbutton.renderTo(t,s)}catch(t){chrome.runtime.sendMessage({type:"error",stack:t.stack,category:"Content"})}})},renderTo:function(t,e){let s,i;const o=document.querySelectorAll(t);for(s=0,i=o.length;s<i;s+=1)o[s].classList.add("toggl");try{for(s=0,i=o.length;s<i;s+=1)e(o[s])}catch(t){chrome.runtime.sendMessage({type:"error",stack:t.stack,category:"Content"})}},topPosition:function(t,e,s){let i=t.left-10,o=t.top+document.body.scrollTop-10;return i+e>window.innerWidth&&(i=window.innerWidth-10-e),o+s>togglbutton.fullPageHeight&&(o=window.innerHeight+document.body.scrollTop-10-s),{left:i,top:o}},calculateTrackedTime:function(){let t=0;const e=togglbutton.mainDescription.toLowerCase(),s=togglbutton.findProjectIdByName(togglbutton.currentProject);return togglbutton.entries&&togglbutton.entries.forEach(function(i){i.description&&i.description.toLowerCase()===e&&i.pid===s&&(t+=i.duration)}),function(t,e){let s;t=Math.abs(t);let i=parseInt(t%60,10),o=parseInt(t/60%60,10),l=parseInt(t/3600,10),n="";return l>0&&(n+=(l=l<10?"0"+l:l)+"h "),o=o<10?"0"+o:o,i=i<10?"0"+i:i,s="improved"===e?l+":"+o+":"+i:"decimal"===e?l+"."+parseInt(100*o/60,10)+"h":n+o+"m "+i+"s"}(t,togglbutton.duration_format)},findProjectByPid:function(t){let e;for(e in togglbutton.user.projectMap)if(togglbutton.user.projectMap.hasOwnProperty(e)&&togglbutton.user.projectMap[e].id===t)return togglbutton.user.projectMap[e]},updateBillable:function(t,e){let s,i,o=togglbutton.user.default_wid;const l=togglbutton.user.workspaces;let n;if(0!==t){if(!(s=togglbutton.findProjectByPid(t)))return;o=s.wid}for(i=0;i<l.length;i++)if(l[i].id===o){n=l[i].premium;break}togglbutton.toggleBillable(n),!e&&0!==t&&s.billable&&togglbutton.$billable.classList.toggle("tb-checked",!0)},toggleBillable:function(t){const e=t?"103":"-1";togglbutton.$billable.setAttribute("tabindex",e),togglbutton.$billable.classList.toggle("no-billable",!t)},setupBillable:function(t,e){togglbutton.updateBillable(e,!0),togglbutton.$billable.classList.toggle("tb-checked",t)},addEditForm:function(t){if(togglbutton.hasTasks=t.hasTasks,null===t||!t.showPostPopup)return;const e=t.entry.pid,s=t.entry.tid,n=document.createElement("div");let c,a;const d=togglbutton.element.getBoundingClientRect();c=$("#toggl-button-edit-form");const u=togglbutton.topPosition(d,240,350);if(null!==c)return(a=$("#toggl-button-description")).value=t.entry.description||"",o.setup(e,s),l.setup(t.entry.tags,t.entry.wid),togglbutton.setupBillable(!!t.entry.billable,e),c.style.left=u.left+"px",c.style.top=u.top+"px",c.style.display="block",void r(a);n.innerHTML=t.html.replace("{service}",togglbutton.serviceName),(c=n.firstChild).style.left=u.left+"px",c.style.top=u.top+"px",c.classList.add("toggl-integration"),document.body.appendChild(c),togglbutton.$billable=$(".tb-billable",c),o=new i.a("project","li",togglbutton),l=new i.b("tag","li",togglbutton);const p=function(){o.closeDropdown(),l.closeDropdown(),c.style.display="none"},h=function(t){/toggl-button/.test(t.target.className)||/toggl-button/.test(t.target.parentElement.className)||(p(),this.removeEventListener("click",h))},g=function(t){const e=o.getSelected(),s=!!document.querySelector(".tb-billable.tb-checked:not(.no-billable)"),i={type:"update",description:$("#toggl-button-description").value,pid:e.pid,projectName:e.name,tags:l.getSelected(),tid:e.tid,billable:s,service:togglbutton.serviceName};chrome.runtime.sendMessage(i),p()};(a=$("#toggl-button-description",c)).value=t.entry.description||"",r(a),o.setup(e,s),l.setSelected(t.entry.tags),l.setWorkspaceId(t.entry.wid),togglbutton.setupBillable(!!t.entry.billable,e),$("#toggl-button-hide",c).addEventListener("click",function(t){p()}),$("#toggl-button-update",c).addEventListener("click",function(t){g()}),$("#toggl-button-update").addEventListener("keydown",function(t){"Enter"!==t.code&&"Space"!==t.code||g()}),$("form",c).addEventListener("submit",function(t){g(),t.preventDefault()}),$(".toggl-button",c).addEventListener("click",function(t){t.preventDefault();const e=togglbutton.element;return e.classList.remove("active"),e.style.color="",e.classList.contains("min")||(e.textContent="Start timer"),chrome.runtime.sendMessage({type:"stop",respond:!0},togglbutton.addEditForm),p(),!1}),$("form",c).addEventListener("keydown",function(t){t.stopPropagation()}),togglbutton.$billable.addEventListener("click",function(){this.classList.toggle("tb-checked")}),togglbutton.$billable.addEventListener("keydown",function(t){let e=!1;"Space"===t.code&&(e=!0,this.classList.toggle("tb-checked")),"ArrowLeft"===t.code&&(e=!0,this.classList.toggle("tb-checked",!1)),"ArrowRight"===t.code&&(e=!0,this.classList.toggle("tb-checked",!0)),e&&(t.stopPropagation(),t.preventDefault())}),o.onChange(function(e){const s=togglbutton.findProjectByPid(e.pid),i=s?s.wid:t.entry.wid;l.setWorkspaceId(i)}),document.addEventListener("click",h)},createTimerLink:function(t){let e=function(t,e,s){e=e||"a",s=s||"#";const i=createTag(e,t);return"a"===e&&(i.href=s),i.appendChild(document.createTextNode("Start timer")),i}("toggl-button");function s(){e.classList.remove("active"),e.style.color="","minimal"!==t.buttonType&&(e.textContent="Start timer")}function i(){const i=e;document.querySelector(".toggl-button.active:not(.toggl-button-edit-form-button)")&&(e=document.querySelector(".toggl-button.active:not(.toggl-button-edit-form-button)"),s(),e=i),e.classList.add("active"),e.style.color="#1ab351","minimal"!==t.buttonType&&(e.textContent="Stop timer")}return togglbutton.currentDescription=n(t.description),togglbutton.currentProject=t.projectName,e.title=n(togglbutton.currentDescription)+(n(togglbutton.currentProject)?" - "+n(togglbutton.currentProject):""),t.calculateTotal&&(togglbutton.mainDescription=n(t.description)),e.classList.add(t.className),togglbutton.serviceName=t.className,"minimal"===t.buttonType&&(e.classList.add("min"),e.removeChild(e.firstChild),e.title="Start timer: "+e.title),e.addEventListener("click",function(o){let l;return o.preventDefault(),o.stopPropagation(),(e=o.target).classList.contains("active")?(s(),l={type:"stop",respond:!0,service:togglbutton.serviceName}):(i(),l={type:"timeEntry",respond:!0,projectId:n(t.projectId),description:n(t.description),tags:n(t.tags),projectName:n(t.projectName),createdWith:togglbutton.fullVersion+"-"+togglbutton.serviceName,service:togglbutton.serviceName,url:window.location.href}),togglbutton.element=o.target,chrome.runtime.sendMessage(l,togglbutton.addEditForm),!1}),togglbutton.links.push({params:t,link:e}),chrome.runtime.sendMessage({type:"currentEntry"},function(t){let o,l;if(t.success)for(o=t.currentEntry,l=0;l<togglbutton.links.length;l++)e=togglbutton.links[l].link,n(togglbutton.links[l].params.description)===o.description?i():s()}),e},updateTimerLink:function(t){let e,s,i,o="",l="";if(!(togglbutton.links.length<1))for(s=0;s<togglbutton.links.length;s++)i=(e=togglbutton.links[s].link).classList.contains("min"),t&&n(togglbutton.links[s].params.description)===t.description?(e.classList.add("active"),l="#1ab351",i||(o="Stop timer")):(e.classList.remove("active"),i||(o="Start timer")),e.style.color=l,e.textContent=o},updateTrackedTimerLink:function(){const t=$(".toggl-tracked");let e,s,i;t&&(e=togglbutton.calculateTrackedTime(),(s=document.createElement("h3")).textContent="Time tracked",(i=document.createElement("p")).setAttribute("title","Time tracked with Toggl: "+e),i.textContent=e,t.appendChild(s),t.appendChild(i))},findProjectIdByName:function(t){let e;for(e in togglbutton.projects)if(togglbutton.projects.hasOwnProperty(e)&&togglbutton.projects[e].name===t)return togglbutton.projects[e].id},newMessage:function(t,e,s){"stop-entry"===t.type?(togglbutton.updateTimerLink(),togglbutton.entries=t.user.time_entries,togglbutton.projects=t.user.projectMap,togglbutton.updateTrackedTimerLink()):"sync"===t.type&&null!==$("#toggl-button-edit-form")&&$("#toggl-button-edit-form").remove()}},chrome.runtime.onMessage.addListener(togglbutton.newMessage),window.addEventListener("focus",function(t){chrome.runtime.sendMessage({type:"currentEntry"},function(t){togglbutton.updateTimerLink(t.currentEntry)})})}});